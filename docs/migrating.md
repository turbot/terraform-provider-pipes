---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pipes Migration"
description: "Migration of existing resource types after upgrade to Terraform provider 0.14.0."
---

# Migration of existing Terraform configuration

This document will outline the steps required to be followed in order to migrate existing Terraform configuration after upgrade to Terraform provider 0.14.0 and above.
Please note the following changes in the provider:
1. `pipes_connection` has been broken down into `pipes_tenant_connection`, `pipes_organization_connection` and `pipes_workspace_connection`. We have also removed support for user level connections. Existing connections defined via `pipes_connection` on organizations needs to be migrated to `pipes_organization_connection`.

2. `pipes_workspace_connection` was used to manage association of connections defined at the identity level to a particular workspace. The resource behaviour has now been modified to manage connections at the workspace level, with Pipes adding support for workspace level connections. The association of connections to workspaces has been replaced by the generic `pipes_workspace_schema` resource which is used to attach / detach connections to / from workspaces. Existing associations defined via `pipes_workspace_connection` needs to be migrated to `pipes_workspace_schema`.

3. We have removed support for user level connections and migrated the connections to the workspaces that they were associated to. Hence, `pipes_connection` used to define user level connections need to be migrated to `pipes_workspace_connection`.

# Migration of org connections and association to workspaces

We are attaching example steps that need to be followed when migrating existing configuration which creates connection at the organization level and associates them to workspaces. Please find the steps as below.

1. Take of back up of the current working directory. This is important to ensure that you can revert back to the previous state in case of any issues.

2. Migrate `pipes_connection` to `pipes_organization_connection` for all connections defined on the organization.
    1. Rename all resources of type `pipes_connection` to `pipes_organization_connection` in your terraform config. Note that the attributes within the resource remain the same.
    2. Rename all references of the resource type `pipes_connection` to `pipes_organization_connection` in your terraform config.
    3. Remove all instances of existing `pipes_connection` config using `terraform state list | grep "pipes_connection." | sed "s/.*/'&'/" | xargs -L 1  terraform state rm`.
    4. Add `connection_import.tf` file to import existing `pipes_organization_connection` config into terraform state. Add an `import` block for each instance of the `pipes_organization_connection` resource of the following format:
        ```
        import {
            to = pipes_organization_connection.<connection_name>
            id = "<organization_handle>/<connection_handle>"
        }
        ```

3. Migrate `pipes_workspace_connection` to `pipes_workspace_schema` for all schema association records.
    1. Rename all instances of type `pipes_workspace_connection` to `pipes_workspace_schema` in your terraform config.
    2. Rename the attribute `workspace_handle` to `workspace` in the new `pipes_workspace_schema` resource.
    3. Remove all instances of existing `pipes_workspace_connection` config using `terraform state list | grep "pipes_workspace_connection." | sed "s/.*/'&'/" | xargs -L 1  terraform state rm`
    4. Add `schema_import.tf` file to import existing `pipes_workspace_schema` config into terraform state. Add an `import` block for each instance of the `pipes_workspace_schema` resource of the following format:
        ```
        import {
            to = pipes_workspace_schema.<schema_name>
            id = "<organization_handle>/<workspace_handle>/<connection_handle>"
        }
        ```

4. Run `terraform plan` to verify the imports and `terraform apply` to apply the changes.
5. Remove the `connection_import.tf` and `schema_import.tf` files.
6. Run `terraform plan` to ensure that pipes is in sync with Terraform.
