---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "pipes_workspace_connection Resource - terraform-provider-pipes"
subcategory: ""
description: |-
  Provides a Pipes Connection resource on a workspace. The `Turbot Pipes Connection` represents a set of tables for a single data source. Each connection is represented as a distinct Postgres schema. In order to query data, you'll need at least one connection.

  Connections can be defined at the tenant, organization or workspace level.
---

# Resource: pipes_workspace_connection

Manages a connection, which is defined on an organization.

## Note

We have changed the usage for the `pipes_workspace_connection` resource. From `0.14.0` version of the provider to have added functionality to manage connections at the workspace level which includes the ability to create, update, and delete connections at the workspace level. Previously, the resource used to manage `attachment` of connections to the workspace defined at the respective identity level. Please follow [insert-document-link] for migrating your existing configuration into the new model.

## Example Usage

**Create an AWS connection in the `playground` workspace for a user**

```hcl
resource "pipes_workspace_connection" "aws_aaa" {
  workspace = "playground"
  plugin = "aws"
  handle = "aws_aaa"
  # Non-sensitive
  config = jsonencode({
    regions = ["us-east-1"]
  })
  # Sensitive
  config_sensitive = jsonencode({
    access_key = "redacted"
    secret_key = "redacted"
  })
}
```

**Create an AWS connection in the `playground` workspace of the `acme` organization**

```hcl
resource "pipes_workspace_connection" "aws_aaa" {
  organization = "acme"
  workspace = "playground"
  plugin = "aws"
  handle = "aws_aaa"
  # Non-sensitive
  config = jsonencode({
    regions = ["us-east-1"]
  })
  # Sensitive
  config_sensitive = jsonencode({
    access_key = "redacted"
    secret_key = "redacted"
  })
}
```

**Create an OCI connection in a connection folder of the `playground` workspace**

```hcl
resource "pipes_workspace_connection" "oci_aaa" {
  workspace = "playground"
  handle       = "oci"
  plugin       = "oci"
  parent_id    = "c_cqlp0647sic7l5q2n5d0"
  # Non-sensitive
  config = jsonencode({
    user_ocid    = "ocid1.user.oc1..aaaaaaaaw..."
    fingerprint  = "f1:fc:44:3a:..."
    tenancy_ocid = "ocid1.tenancy.oc1..aaaaaaaah..."
    regions      = ["ap-mumbai-1", "us-ashburn-1"]
  })
  # Sensitive
  config_sensitive = jsonencode({
    private_key  = file("/Users/myuser/Downloads/mykey.cer")
  })
}
```

## Argument Reference

The following arguments are supported:

- `handle` - (Required) A friendly identifier for your connection, and must be unique across your connections.
- `plugin` - (Required) The name of the plugin.
- `workspace` - (Required) The handle of the workspace where the connection will be managed.
- `config` - (Optional) Configuration for the connection.
- `organization` - (Optional) The handle of the organization which contains the workspace where the connection will be managed.
- `parent_id` - (Optional) Identifier of the connection folder in which the connection will be created. If nothing is passed the connection is created at the root level of the workspace.

For each connection resource, additional arguments are supported based on the plugin it uses. For instance, if creating a connection that uses the Zendesk plugin, the [Zendesk configuration arguments](https://hub.steampipe.io/plugins/turbot/zendesk#configuration) should be used in the connection:

```hcl
resource "pipes_workspace_connection" "zendesk" {
  organization = "acme"
  workspace   = "playground"
  plugin    = "zendesk"
  handle    = "zendesk_example"
  # Non-sensitive
  config = jsonencode({
    subdomain = "dmi"
    email     = "pam@dmi.com"
  })
  # Sensitive
  config_sensitive = jsonencode({
    token = "17ImlCYdfZ3WJIrGk96gCpJn1fi1pLwexample"
  })
}
```

We do not recommend storing sensitive or secret information in such a way that it's accidentally exposed or can be accessed by unwanted actors. For more information on how to protect sensitive information, please see [Protect Sensitive Input Variables](https://learn.hashicorp.com/tutorials/terraform/sensitive-variables).

## Attributes Reference

In addition to all arguments above, the following attributes are exported:

- `config_source` - Source of the public configuration for the connection. Possible values are `self` or `inherited`. If `inherited`, the connection uses the configuration from the integration that is managing it.
- `connection_id` - Unique identifier of the connection.
- `created_at` - The time when the connection was created.
- `created_by` - The handle of the user who created the connection.
- `credential_source` - Source of the secret credentials for the connection. Possible values are `self` or `inherited`. If `inherited`, the connection uses the credentials from the integration that is managing it.
- `handle_dynamic` - The dynamic handle assigned to the connection when it is discovered by an integration.
- `handle_mode` - Mode of the handle for the connection. Possible values are `static` or `dynamic`. If `dynamic`, the handle is assigned when the connection is discovered by an integration and can be overridden by the user.
- `identity_id` - Unique identifier of the identity which contains the workspace where the connection is managed.
- `integration_resource_identifier` - Unique identifier of the resource if the connection is managed by an integration.
- `integration_resource_name` - Name of the resource if the connection is managed by an integration.
- `integration_resource_path` - Path of the resource in the hierarchy if the connection is managed by an integration.
- `integration_resource_type` - Type of the resource if the connection is managed by an integration. For example, if the connection is managed by an AWS integration, the value will be `aws_account`.
- `managed_by_id` - Unique identifier of the integration that is managing the connection, if any.
- `plugin_version` - The version of the plugin being used by the connection.
- `tenant_id` - Unique identifier of the tenant where the connection exists.
- `trunk` - An array of items that represent the path of the connection in the hierarchy, ordered from ancestor to parent.
- `type` - Denotes whether the connection is discovered or manually created. Possible values are `connection` or `connection-discovered`.
- `updated_at` - The time when the connection was last updated.
- `updated_by` - The handle of the user who last updated the connection.
- `status` - The current status of the connection.
- `last_error_at` - The time when the last error occurred for the connection.
- `last_error_process_id` - The identifier of the process that encountered the last error.
- `last_successful_update_at` - The time when the connection was last successfully updated.
- `last_successful_update_process_id` - The identifier of the process that last successfully updated the connection.
- `last_update_attempt_at` - The time when the most recent update attempt was made for the connection.
- `last_update_attempt_process_id` - The identifier of the process that made the most recent update attempt.
- `version_id` - The connection version.
- `workspace_id` - Unique identifier of the workspace where the connection exists.

## Import

### Import User Workspace Connection

User workspace connections can be imported with an ID made up of `workspace_handle/connection_handle`, e.g.,

```sh
terraform import pipes_workspace_connection.example finance/aws_aaa
```

### Import Organization Workspace Connection

Organization workspce connections can be imported with an ID made up of `organization_handle/workspace_handle/connection_handle`, e.g.,

```sh
terraform import pipes_workspace_connection.example acme/finance/aws_aaa
```


## Config vs Config_Sensitive

Use config for non-sensitive settings and config_sensitive for secrets (access keys, tokens, etc); `config_sensitive` is `write only` and therefore not stored in `state`, therefore if this is the only change on the resource Terraform will be unable to detect this. 